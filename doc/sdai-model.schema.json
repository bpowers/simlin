{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "SdaiModel",
  "type": "object",
  "properties": {
    "variables": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/Variable"
      }
    },
    "relationships": {
      "type": [
        "array",
        "null"
      ],
      "items": {
        "$ref": "#/$defs/Relationship"
      }
    },
    "specs": {
      "anyOf": [
        {
          "$ref": "#/$defs/SimSpecs"
        },
        {
          "type": "null"
        }
      ]
    },
    "views": {
      "type": [
        "array",
        "null"
      ],
      "items": {
        "$ref": "#/$defs/View"
      }
    }
  },
  "required": [
    "variables"
  ],
  "$defs": {
    "Variable": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "stock"
            }
          },
          "$ref": "#/$defs/StockFields",
          "required": [
            "type"
          ]
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "flow"
            }
          },
          "$ref": "#/$defs/FlowFields",
          "required": [
            "type"
          ]
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "variable"
            }
          },
          "$ref": "#/$defs/AuxiliaryFields",
          "required": [
            "type"
          ]
        }
      ]
    },
    "GraphicalFunction": {
      "type": "object",
      "properties": {
        "points": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Point"
          }
        }
      },
      "required": [
        "points"
      ]
    },
    "Point": {
      "type": "object",
      "properties": {
        "x": {
          "type": "number",
          "format": "double"
        },
        "y": {
          "type": "number",
          "format": "double"
        }
      },
      "required": [
        "x",
        "y"
      ]
    },
    "StockFields": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "equation": {
          "type": [
            "string",
            "null"
          ]
        },
        "documentation": {
          "type": [
            "string",
            "null"
          ]
        },
        "units": {
          "type": [
            "string",
            "null"
          ]
        },
        "inflows": {
          "type": [
            "array",
            "null"
          ],
          "items": {
            "type": "string"
          }
        },
        "outflows": {
          "type": [
            "array",
            "null"
          ],
          "items": {
            "type": "string"
          }
        },
        "graphicalFunction": {
          "anyOf": [
            {
              "$ref": "#/$defs/GraphicalFunction"
            },
            {
              "type": "null"
            }
          ]
        }
      },
      "required": [
        "name"
      ]
    },
    "FlowFields": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "equation": {
          "type": [
            "string",
            "null"
          ]
        },
        "documentation": {
          "type": [
            "string",
            "null"
          ]
        },
        "units": {
          "type": [
            "string",
            "null"
          ]
        },
        "graphicalFunction": {
          "anyOf": [
            {
              "$ref": "#/$defs/GraphicalFunction"
            },
            {
              "type": "null"
            }
          ]
        }
      },
      "required": [
        "name"
      ]
    },
    "AuxiliaryFields": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "equation": {
          "type": [
            "string",
            "null"
          ]
        },
        "documentation": {
          "type": [
            "string",
            "null"
          ]
        },
        "units": {
          "type": [
            "string",
            "null"
          ]
        },
        "graphicalFunction": {
          "anyOf": [
            {
              "$ref": "#/$defs/GraphicalFunction"
            },
            {
              "type": "null"
            }
          ]
        }
      },
      "required": [
        "name"
      ]
    },
    "Relationship": {
      "type": "object",
      "properties": {
        "reasoning": {
          "type": [
            "string",
            "null"
          ]
        },
        "from": {
          "type": "string"
        },
        "to": {
          "type": "string"
        },
        "polarity": {
          "$ref": "#/$defs/Polarity"
        },
        "polarityReasoning": {
          "type": [
            "string",
            "null"
          ]
        }
      },
      "required": [
        "from",
        "to",
        "polarity"
      ]
    },
    "Polarity": {
      "description": "Polarity of a causal relationship in a system dynamics model.\nIndicates whether an increase in the source variable causes an\nincrease (+), decrease (-), or unknown effect (?) on the target.",
      "oneOf": [
        {
          "description": "Positive polarity: increase in source causes increase in target",
          "type": "string",
          "const": "+"
        },
        {
          "description": "Negative polarity: increase in source causes decrease in target",
          "type": "string",
          "const": "-"
        },
        {
          "description": "Unknown polarity: relationship exists but direction of effect is unclear",
          "type": "string",
          "const": "?"
        }
      ]
    },
    "SimSpecs": {
      "type": "object",
      "properties": {
        "startTime": {
          "type": "number",
          "format": "double"
        },
        "stopTime": {
          "type": "number",
          "format": "double"
        },
        "dt": {
          "type": [
            "number",
            "null"
          ],
          "format": "double"
        },
        "timeUnits": {
          "type": [
            "string",
            "null"
          ]
        },
        "saveStep": {
          "type": [
            "number",
            "null"
          ],
          "format": "double"
        },
        "method": {
          "type": [
            "string",
            "null"
          ]
        }
      },
      "required": [
        "startTime",
        "stopTime"
      ]
    },
    "View": {
      "type": "object",
      "properties": {
        "kind": {
          "type": "string"
        },
        "elements": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/ViewElement"
          }
        },
        "view_box": {
          "anyOf": [
            {
              "$ref": "#/$defs/Rect"
            },
            {
              "type": "null"
            }
          ]
        },
        "zoom": {
          "type": "number",
          "format": "double"
        }
      },
      "required": [
        "elements"
      ]
    },
    "ViewElement": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "stock"
            }
          },
          "$ref": "#/$defs/StockViewElement",
          "required": [
            "type"
          ]
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "flow"
            }
          },
          "$ref": "#/$defs/FlowViewElement",
          "required": [
            "type"
          ]
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "aux"
            }
          },
          "$ref": "#/$defs/AuxiliaryViewElement",
          "required": [
            "type"
          ]
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "cloud"
            }
          },
          "$ref": "#/$defs/CloudViewElement",
          "required": [
            "type"
          ]
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "link"
            }
          },
          "$ref": "#/$defs/LinkViewElement",
          "required": [
            "type"
          ]
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "module"
            }
          },
          "$ref": "#/$defs/ModuleViewElement",
          "required": [
            "type"
          ]
        },
        {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "const": "alias"
            }
          },
          "$ref": "#/$defs/AliasViewElement",
          "required": [
            "type"
          ]
        }
      ]
    },
    "StockViewElement": {
      "type": "object",
      "properties": {
        "uid": {
          "type": "integer",
          "format": "int32"
        },
        "name": {
          "type": "string"
        },
        "x": {
          "type": "number",
          "format": "double"
        },
        "y": {
          "type": "number",
          "format": "double"
        },
        "label_side": {
          "type": "string"
        }
      },
      "required": [
        "uid",
        "name",
        "x",
        "y"
      ]
    },
    "FlowPoint": {
      "type": "object",
      "properties": {
        "x": {
          "type": "number",
          "format": "double"
        },
        "y": {
          "type": "number",
          "format": "double"
        },
        "attached_to_uid": {
          "type": "integer",
          "format": "int32"
        }
      },
      "required": [
        "x",
        "y"
      ]
    },
    "FlowViewElement": {
      "type": "object",
      "properties": {
        "uid": {
          "type": "integer",
          "format": "int32"
        },
        "name": {
          "type": "string"
        },
        "x": {
          "type": "number",
          "format": "double"
        },
        "y": {
          "type": "number",
          "format": "double"
        },
        "label_side": {
          "type": "string"
        },
        "points": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/FlowPoint"
          }
        }
      },
      "required": [
        "uid",
        "name",
        "x",
        "y",
        "points"
      ]
    },
    "AuxiliaryViewElement": {
      "type": "object",
      "properties": {
        "uid": {
          "type": "integer",
          "format": "int32"
        },
        "name": {
          "type": "string"
        },
        "x": {
          "type": "number",
          "format": "double"
        },
        "y": {
          "type": "number",
          "format": "double"
        },
        "label_side": {
          "type": "string"
        }
      },
      "required": [
        "uid",
        "name",
        "x",
        "y"
      ]
    },
    "CloudViewElement": {
      "type": "object",
      "properties": {
        "uid": {
          "type": "integer",
          "format": "int32"
        },
        "flow_uid": {
          "type": "integer",
          "format": "int32"
        },
        "x": {
          "type": "number",
          "format": "double"
        },
        "y": {
          "type": "number",
          "format": "double"
        }
      },
      "required": [
        "uid",
        "flow_uid",
        "x",
        "y"
      ]
    },
    "LinkPoint": {
      "type": "object",
      "properties": {
        "x": {
          "type": "number",
          "format": "double"
        },
        "y": {
          "type": "number",
          "format": "double"
        }
      },
      "required": [
        "x",
        "y"
      ]
    },
    "LinkViewElement": {
      "type": "object",
      "properties": {
        "uid": {
          "type": "integer",
          "format": "int32"
        },
        "from_uid": {
          "type": "integer",
          "format": "int32"
        },
        "to_uid": {
          "type": "integer",
          "format": "int32"
        },
        "arc": {
          "type": [
            "number",
            "null"
          ],
          "format": "double"
        },
        "multi_points": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/LinkPoint"
          }
        }
      },
      "required": [
        "uid",
        "from_uid",
        "to_uid"
      ]
    },
    "ModuleViewElement": {
      "type": "object",
      "properties": {
        "uid": {
          "type": "integer",
          "format": "int32"
        },
        "name": {
          "type": "string"
        },
        "x": {
          "type": "number",
          "format": "double"
        },
        "y": {
          "type": "number",
          "format": "double"
        },
        "label_side": {
          "type": "string"
        }
      },
      "required": [
        "uid",
        "name",
        "x",
        "y"
      ]
    },
    "AliasViewElement": {
      "type": "object",
      "properties": {
        "uid": {
          "type": "integer",
          "format": "int32"
        },
        "alias_of_uid": {
          "type": "integer",
          "format": "int32"
        },
        "x": {
          "type": "number",
          "format": "double"
        },
        "y": {
          "type": "number",
          "format": "double"
        },
        "label_side": {
          "type": "string"
        }
      },
      "required": [
        "uid",
        "alias_of_uid",
        "x",
        "y"
      ]
    },
    "Rect": {
      "type": "object",
      "properties": {
        "x": {
          "type": "number",
          "format": "double"
        },
        "y": {
          "type": "number",
          "format": "double"
        },
        "width": {
          "type": "number",
          "format": "double"
        },
        "height": {
          "type": "number",
          "format": "double"
        }
      },
      "required": [
        "x",
        "y",
        "width",
        "height"
      ]
    }
  }
}